# 数学の新しい基礎づけ — 第4章：交代級数 ― “挟み込み”と和の宣言〔md版・本編〕

> 本章は、**交代級数**を「**二列の挟み込み**」として捉え、1章で導入した**隣接関係子（##／♭♭）**と**連続順序数 $M$** を用いて「**和の宣言**」を与える。形式的な検査は、2・3章で確定した**最小 λ計算**の語彙と評価機で行い、**β簡約ログ＝証拠**として保存できるようにする（本章内のスニペットはそのまま流用可能）。&#x20;

---

## 4-0　目的と位置付け

* 交代級数を**二つの収束列**（上からの列 $A_m$、下からの列 $B_m$）として表現し、常に $B_m<A_m$ かつ $A_{m+1}<A_m$, $B_m<B_{m+1}$ を満たす状況に着目する。
* そのとき、**連続順序数 $M$** の語彙で「**$A_m^{\flat\flat}=B_m$**（同値に $B_m^{\##}=A_m$）」が成り立つと見なせる場合、**その間**の $A_m^\flat$（≡ $B_m^\#$）を**級数の和**として**宣言**する。これを本稿の\*\*“挟み込み＝和”\*\*の原則と呼ぶ。

---

## 4-1　定義：交代級数の“挟み込み”と和の宣言

**定義 4.1（交代級数の挟み込みペア）**
正項列 $\{t_k\}_{k\ge0}$（単調減少かつ $t_k\to 0$ を想定）に対し、部分和

$$
S_n := \sum_{k=0}^{n}(-1)^k\,t_k
$$

から二列

$$
A_m := S_{2m},\qquad B_m := S_{2m+1}
$$

を作る。すると経験的に $B_m<A_m$、$A_{m+1}<A_m$、$B_m<B_{m+1}$ が成り立つ（4-4 参照）。

**定義 4.2（“挟み込み＝和”の宣言）**
任意の $m$ に対し

$$
A_m^{\flat\flat}=B_m \quad\text{（同値に } B_m^{\##}=A_m\text{）}
$$

と見なせるとき、その**間**を

$$
\boxed{\quad \text{Sum} := A_m^\flat \equiv B_m^\# \quad}
$$

と**宣言**する（“平均”は近似としては有用だが定義ではない）。ここで $(\cdot)^\flat,(\cdot)^\#$ は 1 章の**隣接関係子**で導入した **$M=(k,a)$** の段数 $k$ を $-1,+1$ シフトする操作である。

> **備考**：本宣言は**極限値を仮定しない**。2 列の**順序関係**だけで“和”を定義するため、以後の $\mathbb{CR}$（新実数）側へも自然に移植できる。

---

## 4-2　実装の受け口（再掲）と再現プロトコル（最小）

* **評価系**：2 章の**左最外（正規順序）**インタプリタを用い、各主張は**βログ**で検査・保存する。
* **語彙**：3 章で確定した `Nat/Z/Rat`、`Rat_norm`、`M=(k,a)`、`CR`、`cmpM/cmpCR`、および `Assert` を利用する。必要に応じて `Fix`（不動点）で再帰を記述する。
* **コード配置**：大きな定義群は**巻末 Code Slot**（C/D/E）に一括し、本章では**検査スクリプト**を中心に掲載する（実装は 2・3 章のスロットと同一）。

---

## 4-3　例：ライプニッツ級数 $\displaystyle \frac{\pi}{4}=\sum_{k=0}^{\infty}\frac{(-1)^k}{2k+1}$

### 4-3-1　二列の定義と基本性質（Rat 上）

$$
S_n:=\sum_{k=0}^{n}\frac{(-1)^k}{2k+1},\quad
A_m:=4S_{2m},\quad B_m:=4S_{2m+1}.
$$

差分形で書くと

$$
\begin{aligned}
A_{m+1}-A_m &= 4\!\left(-\frac{1}{4m+3}+\frac{1}{4m+5}\right) < 0,\\
B_{m+1}-B_m &= 4\!\left(+\frac{1}{4m+3}-\frac{1}{4m+5}\right) > 0,
\end{aligned}
$$

ゆえに $A_m$ は**単調減少**・$B_m$ は**単調増加**、かつ常に $B_m<A_m$ が成り立つ。
（“$<0$,$>0$” の判定は **Rat の差の符号**で機械的に検証できる。）

### 4-3-2　代表値（最初の段階）

| $m$ | $A_m=4S_{2m}$  | 10進近似             | $B_m=4S_{2m+1}$ | 10進近似            | 関係        |
| --: | :------------- | :---------------- | :-------------- | :--------------- | :-------- |
|   0 | $4/1$          | $4.0$             | $8/3$           | $2.\overline{6}$ | $B_0<A_0$ |
|   1 | $52/15$        | $3.4\overline{6}$ | $304/105$       | $2.895238\ldots$ | $B_1<A_1$ |
|   2 | $1052/315$     | $3.3396825\ldots$ | $10312/3465$    | $2.976046\ldots$ | $B_2<A_2$ |
|   3 | $147916/45045$ | $3.283738\ldots$  | $135904/45045$  | $3.017072\ldots$ | $B_3<A_3$ |

> これらの有理表示は 1 章の表と整合する（10進は説明用）。**定義としての和**は「**$A_m^\flat=B_m^\#$**」で与える（平均は近似目的のみ）。

### 4-3-3　検査スクリプト（そのまま貼付可）

> ここでは **λ語彙は既出**（3 章）を前提とし、**Rat の四則＋比較**と `Assert` を用いる。実装の本体は Code Slot C/D/E にある。

```lambda
; ==== constants ====
Nat1=Succ Zero; Nat2=Succ Nat1; Nat3=Succ Nat2; Nat4=Succ Nat3;
Q_of_nat = \n. Pair (Zpos n) (Zpos Nat1);
Q4 = Q_of_nat Nat4;

; 1/(2k+1)
OddDen = \k. Q_of_nat (Succ (Add k k));
Term = \k. Rat_div_norm Q1 (OddDen k);

; 部分和 S_n（Fixで後ろから畳み込む）
S = Fix (\rec.\n.
      If (IsZero n)
         (Rat_div_norm Q1 (OddDen Zero))                   ; 1/1
         (let n1 = Pred n in
          let sn1 = rec n1 in
          If (IsZero (Mod2 n))                             ; Mod2: 偶奇判定。E slot 実装想定
             (Rat_add_norm sn1 (Rat_div_norm Q1 (OddDen n)))
             (Rat_sub_norm sn1 (Rat_div_norm Q1 (OddDen n)))));

A = \m. Rat_mul_norm Q4 (S (Mul Nat2 m));                  ; A_m = 4*S_{2m}
B = \m. Rat_mul_norm Q4 (S (Succ (Mul Nat2 m)));           ; B_m = 4*S_{2m+1}

; 単調と挟み込みのチェック
A_dec = \m. Rat_lt (A (Succ m)) (A m);                     ; A_{m+1} < A_m
B_inc = \m. Rat_lt (B m) (B (Succ m));                     ; B_m < B_{m+1}
Clamp = \m. Rat_lt (B m) (A m);                            ; B_m < A_m

; バッチ検査（m=0..3）
List4 = Cons Zero (Cons Nat1 (Cons Nat2 (Cons Nat3 Nil)));
Batch = Foldr (\m.\acc. And (And (A_dec m) (And (B_inc m) (Clamp m))) acc) True List4;

Assert Batch ; True になれば OK

; “和の宣言”：この章では宣言のみ。計算上は A_m^♭ と B_m^# の関係を M/CR へ橋渡し（Code Slot D）。
```

> **注**：`Mod2`（偶奇判定）や `Foldr` はテスト・ハーネスに含める（Code Slot E）。**βログ**は UI が逐次出力する。

---

## 4-4　一般形：単調減少 $t_k\downarrow0$ のときの性質（Rat の計算で検証可能）

**命題 4.3（単調と挟み込み）**
$t_k>0$、$t_{k+1}\le t_k$、$t_k\to 0$ とする。

$$
A_m=S_{2m},\quad B_m=S_{2m+1}
$$

に対し、**常に** $B_m<A_m$、かつ $A_{m+1}<A_m$, $B_m<B_{m+1}$ が成り立つ。

**（証拠の方針）**
差分

$$
A_{m+1}-A_m=-(t_{2m+1}-t_{2m+2})<0,\quad
B_{m+1}-B_m=+(t_{2m+1}-t_{2m+2})>0
$$

を **Rat の差の符号**で確かめる。汎用のケースでは $t_k$ の生成器を λ で与え、`Assert` を通す。

**命題 4.4（“和の宣言”の独立性）**
$A_m^{\flat\flat}=B_m$ が任意の $m$ で成り立つとき、

$$
A_m^\flat = B_m^\#
$$

は $m$ に依らず**同一の $M$ の元**を与え、これを**級数の和**と呼ぶ。
*（スケッチ）*：辞書式順序の下、$\{(0,A_m)\}$ と $\{(0,B_m)\}$ は互いに**一段差**で平行移動する。よって**間の元**は常に一致する。

---

## 4-5　別例：交代調和級数 $\displaystyle \ln 2=\sum_{k=0}^{\infty}\frac{(-1)^k}{k+1}$

**二列** $A_m=S_{2m}, B_m=S_{2m+1}$ を同様に定める。差分は

$$
A_{m+1}-A_m= -\frac{1}{2m+2} + \frac{1}{2m+3}<0,\quad
B_{m+1}-B_m= +\frac{1}{2m+2} - \frac{1}{2m+3}>0,
$$

ゆえに**挟み込み**が成り立つ。
**宣言**：$(A_m^\flat=B_m^\#)$ を**和** $\ln 2$ とする（定義）。

**検査スクリプト（抜粋）**（構成は 4-3 と同様、`OddDen` を `Succ k` に置換）

```lambda
TermH = \k. Rat_div_norm Q1 (Q_of_nat (Succ k));     ; t_k = 1/(k+1)
; S, A, B の構成は同形
; A_dec/B_inc/Clamp を m=0..N で Assert
```

---

## 4-6　“平均”の位置づけと近似

**命題 4.5（中点は常に区間内）**
$\mathrm{mid}_m:=\frac{A_m+B_m}{2}$ は常に $B_m<\mathrm{mid}_m<A_m$ を満たす。
*（Rat の四則で βログ検査）*

> **注意**：$\mathrm{mid}_m$ は**近似**として有用だが、**定義上の和**は $A_m^\flat=B_m^\#$ である（“半段の隣”という情報を保持するため）。

---

## 4-7　$M$／$\mathbb{CR}$ への橋渡し

* $M$ では「隣」を**段数 $k$** の $\pm1$ シフトで表現し、**和**を $A_m^\flat$ と**宣言**する（4-1）。
* $\mathbb{CR}$ では $x-y$ の\*\*$\mathrm{ord}_0$\*\* と**先頭係数符号**で順序を判定し、上記の挙動を**QPoly 比**の正規化で再現する。
* 代表例（ライプニッツ）：

  $$
  B_m < \pi < A_m,\qquad \text{かつ}\quad A_m^\flat = B_m^\# = \pi
  $$

  と**定義**する（$\pi$ は**宣言された元**）。**βログ**は、$B_m<A_m$・単調・中点内在・隣接関係の確認から得られる。

---

## 4-8　再現手順（評価機での実験プロトコル）

1. 評価機（v4→v6 系）を起動し、**Code Slot C/D/E** を読み込む（3 章末参照）。
2. 本章 4-3/4-5 の**検査スクリプト**を貼付して `Evaluate`。
3. **Steps** 領域に出る**βログ**を証拠として保存：

   * `A_{m+1}<A_m`、`B_m<B_{m+1}`、`B_m<A_m`（複数 m）
   * 中点 $\mathrm{mid}_m$ の内在
   * 宣言「$A_m^\flat=B_m^\#$ を和とする」
4. さらに $\mathbb{CR}$ 側の比較器 `cmpCR` でも**差の ord₀＋符号**で挙動を確認。

---

## 4-9　拡張の見取り図（将来の 4 章／5 章以降）

* **他の交代級数**：$\arctan$、$\ln(1+x)$、交代バーゼル型などを**同一プロトコル**で検査。
* **加速法の実装**：Aitken $\Delta^2$、Euler 変換を $\mathbb{CR}$ の QPoly 比に適用し、挟み込みの**収束速度**を比較。
* **連分数との接続**：二列の挟み込みを**ペアの連分数**として再表現し、隣接関係と**収束段数**の対応を調べる。
* **定義の一般化**：単調性が破れる場合の**局所再配列**・区間の**再宣言**など、実運用向けの強化。

> 以上は本章の原則を保ったまま**ケース表＋βログ**で機械検証できる構成を想定する。

---

## 4-10　章末まとめ

* 交代級数を**二列の挟み込み**で捉え、**隣接関係子**により「**間**」を**和**として**宣言**した。
* ライプニッツ級数・交代調和級数で、**単調・挟み込み・中点内在**を**Rat の演算と比較**で機械検査できることを示した。
* $\mathbb{CR}$ への橋渡しにより、**ord₀＋符号**の比較で同等の順序情報を保持できる。
* 近似（平均）は**区間内**に入るが、**定義**上の和は $A_m^\flat=B_m^\#$ である――これにより\*\*“半段の隣”\*\*という微細な情報を維持したまま、級数の和を扱える。

---

### 付記：本章で参照した既存資料

* **第1章の定義・記法（##／♭♭・$M$・$\mathbb{CR}$）**：本章の“挟み込み＝和”の宣言は 1 章の立場に準拠している。
* **最小 λ評価機（v4→v6 系）**：βログ（逐次）・正規順序・環境展開・循環検出の UI 仕様に準拠。再現手順・ログ保存は 2 章と同様。

---
